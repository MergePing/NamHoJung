<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>회원조회</title>
    <link rel="stylesheet" th:href="@{/css/adminmanagement.css}">
</head>
<body>
<div class="container">
    <div class="background">
        <img class="img" th:src="@{/images/admin/background.png}" alt="배경 이미지">
    </div>

    <header>
        <nav>
            <img th:src="@{/images/main/nav-logo-dark.png}" alt="상단 로고">
            <span>소개</span>
            <span>공지사항</span>
            <span>게시판</span>
            <span>MBTI 검사</span>
            <span>마이페이지</span>
            <span>로그인</span>
            <span>회원가입</span>
        </nav>
    </header>

    <!-- 검색창 -->
    <input type="text" placeholder="검색어를 입력하세요" id="search1" class="search-box">

    <!-- 분류 창 -->
    <main class="main">
        <div class="top-nav">
            <span>회원번호</span>
            <span>회원닉네임</span>
            <span>등급</span>
            <span>회원 이름</span>
            <span>신고횟수</span>
            <span>탈퇴여부</span>
        </div>

        <!-- 회원 리스트 -->
        <div th:each="user : ${userList}"
             class="member-item"
             th:attr="data-user-id=${user.userNo}"
             onclick="openModal(this)">
            <span th:text="${user.userNo}"></span>
            <span th:text="${user.userId}"></span>
            <span th:text="${user.level}"></span>
            <span th:text="${user.userName}"></span>
            <span th:text="${user.reportCount}"></span>
            <span th:text="${user.isDeleted ? '탈퇴' : '활성'}"></span>
        </div>
        <!-- 페이지네이션 -->
        <div class="pagination">
            <span th:each="i : ${#numbers.sequence(startPage, endPage)}">
                <a th:href="@{/admin/users(page=${i})}"
                   th:text="${i}"
                   th:classappend="${i == currentPage} ? 'active' : ''"></a>
            </span>
        </div>
    </main>
        </div>
    </div>


    <script>
        function openModal(element) {
            // 선택한 요소의 data-user-id 속성 값을 가져옴
            const userId = element.getAttribute("data-user-id");

            // 데이터 가져오기
            fetch(`/admin/user/${userId}`)
                .then(response => response.json())
                .then(data => {
                    document.getElementById("modalNickname").textContent = data.userId;
                    document.getElementById("modalReportCount").textContent = data.reportCount;
                    document.getElementById("userModal").style.display = 'block';
                })
                .catch(error => console.error('Error fetching user details:', error));
        }
        function closeModal() {
            document.getElementById("userModal").style.display = 'none';
        }
    </script>
</div>
</body>
</html>